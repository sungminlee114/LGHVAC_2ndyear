[
  {
    "Input": "오늘 4층의 평균 실내온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-17') AND timestamp < DATE_TRUNC('day', DATE '2022-09-17' + INTERVAL '1 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-17') AND timestamp < DATE_TRUNC('day', DATE '2022-09-17' + INTERVAL '1 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  }
,
   {
    "Input": "4층에서 에어컨 꺼진 방들 알려줘",
    "Tags": {
  "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-17 16:30:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-17 16:30:00' AND oper IS NOT NULL ORDER BY timestamp;",
  "result_name": "qr",
  
  "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-17 16:30:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-17 16:30:00' AND oper IS NOT NULL ORDER BY timestamp) SELECT ARRAY_AGG(idu_name ORDER BY idu_name) AS off_names FROM qr WHERE oper = FALSE AND timestamp = (SELECT MAX(timestamp) FROM qr);",
  "final_result": "result"

    }
  },


{
  "Input": "4층에서 가장 추운 방은 어디야?",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-17 16:30:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-17 16:30:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-17 16:30:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-17 16:30:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT ARRAY_AGG(DISTINCT idu_name ORDER BY idu_name) AS coldest_rooms, MIN(roomtemp) AS coldest_temp FROM qr WHERE  roomtemp = (SELECT MIN(roomtemp) FROM qr);",
    "final_result": "result"
  }
}
,


  {
    "Input": "4층의 지난달 설정온도 최대값과 최소값 알려줘",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= DATE '2022-09-17' - INTERVAL '1 month' AND timestamp <= DATE '2022-09-17' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= DATE '2022-09-17' - INTERVAL '1 month' AND timestamp <= DATE '2022-09-17' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT MAX(settemp) AS settemp_max, MIN(settemp) AS settemp_min FROM qr;",
  "final_result": "result"
    }
  },

{
  "Input": "오늘 4층에서 가장 더운 방은 어디야?",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-17') AND timestamp < DATE_TRUNC('day', DATE '2022-09-17' + INTERVAL '1 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-17') AND timestamp < DATE_TRUNC('day', DATE '2022-09-17' + INTERVAL '1 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT ARRAY_AGG(DISTINCT idu_name ORDER BY idu_name) AS hottest_rooms, MAX(roomtemp) AS hottest_temp FROM qr WHERE roomtemp = (SELECT MAX(roomtemp) FROM qr);",
    "final_result": "result"
  }
}
,


  {
    "Input": "오늘 4층의 평균 설정온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-17') AND timestamp < DATE_TRUNC('day', DATE '2022-09-17' + INTERVAL '1 day') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-17') AND timestamp < DATE_TRUNC('day', DATE '2022-09-17' + INTERVAL '1 day') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(settemp) AS settemp_avg FROM qr;",
  "final_result": "result"
    }
  },

 
  {
    "Input": "에어컨 전원이 켜진 4층 방들 알려줘",
    "Tags": {
  "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-17 16:30:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-17 16:30:00' AND oper IS NOT NULL ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84', '02_I85', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-17 16:30:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-17 16:30:00' AND oper IS NOT NULL ORDER BY timestamp) SELECT ARRAY_AGG(idu_name ORDER BY idu_name) AS on_names FROM qr WHERE oper = True AND timestamp = (SELECT MAX(timestamp) FROM qr);",
  "final_result": "result"
    }
  },

 
  {
    "Input": "오늘 우리반의 가장 최근 설정온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84')) AND timestamp >= TIMESTAMP '2022-09-17 16:30:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-17 16:30:00' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I84')) AND timestamp >= TIMESTAMP '2022-09-17 16:30:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-17 16:30:00' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT settemp  AS settemp_recent, timestamp AS recent_time FROM qr ORDER  BY timestamp DESC LIMIT  1;",
  "final_result": "result"
    }
  }
]