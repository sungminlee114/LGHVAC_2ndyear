[
  {
    "Input": "어제 우리반과 옆반의 설정온도 차이 알려줘",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), t AS (SELECT AVG(CASE WHEN idu_name = '01_IB5' THEN settemp END) AS settemp_ours,AVG(CASE WHEN idu_name = '01_IB7' THEN settemp END) AS settemp_beside  FROM qr)SELECT settemp_ours, settemp_beside,  settemp_ours - settemp_beside AS settemp_diff FROM t;",
  "final_result": "result"
    }
  },
  {
    "Input": "오늘 우리반과 옆반의 평균 온도차이 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' + INTERVAL '1 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' + INTERVAL '1 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), t AS (SELECT AVG(CASE WHEN idu_name = '01_IB5' THEN roomtemp END) AS roomtemp_ours,  AVG(CASE WHEN idu_name = '01_IB7' THEN roomtemp END) AS roomtemp_beside   FROM qr ) SELECT roomtemp_ours, roomtemp_beside, roomtemp_ours - roomtemp_beside AS temp_diff FROM t;",
  "final_result": "result"
    }
  },
  {
    "Input": "작년 겨울 우리반 평균온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE '2022-12-01' - INTERVAL '1 year' AND timestamp < DATE '2022-03-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE '2022-12-01' - INTERVAL '1 year' AND timestamp < DATE '2022-03-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "올해 여름 앞반 평균온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I81')) AND timestamp >= DATE '2022-06-01' AND timestamp < DATE '2022-09-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp;",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I81')) AND timestamp >= DATE '2022-06-01' AND timestamp < DATE '2022-09-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "올해 봄 옆반 제일 추웠던 날 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE '2022-03-01' AND timestamp < DATE '2022-06-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE '2022-03-01' AND timestamp < DATE '2022-06-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), t AS (SELECT MIN(roomtemp) AS coldest_temp FROM qr) SELECT ARRAY(SELECT TO_CHAR(timestamp, 'YYYY-MM-DD') FROM qr, t WHERE qr.roomtemp = t.coldest_temp) AS coldest_dates, coldest_temp FROM t;",
  "final_result": "result"
    }
  },
  {
    "Input": "4월 앞반 평균온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I81')) AND timestamp >= DATE '2022-04-01' AND timestamp < DATE '2022-05-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I81')) AND timestamp >= DATE '2022-04-01' AND timestamp < DATE '2022-05-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  },
{
  "Input": "이번달 중 우리반 온도가 가장 덜 더운날이 언제야?",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30' + INTERVAL '1 month') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30' + INTERVAL '1 month') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), minv AS (SELECT MIN(roomtemp) AS coldest_temp FROM qr) SELECT ARRAY_AGG(DISTINCT TO_CHAR(timestamp, 'YYYY-MM-DD') ORDER BY TO_CHAR(timestamp, 'YYYY-MM-DD')) AS coldest_dates, (SELECT coldest_temp FROM minv) AS coldest_temp FROM qr, minv WHERE qr.roomtemp = minv.coldest_temp;",
    "final_result": "result"
  }
}



,

{
  "Input": "2주전 우리반과 옆반 합쳐서 설정온도가 가장 낮은날이 언제야?",
  "Tags": {
    "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '2 week') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
          "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '2 week') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), coldest AS (SELECT MIN(settemp) AS coldest_temp FROM qr) SELECT ARRAY_AGG(DISTINCT TO_CHAR(timestamp,'YYYY-MM-DD') ORDER BY TO_CHAR(timestamp,'YYYY-MM-DD')) AS coldest_dates, coldest_temp FROM qr, coldest WHERE qr.settemp = coldest.coldest_temp GROUP BY coldest_temp;",
    "final_result": "result"
  }
}
,

  {
    "Input": "우리반의 가장 최근 설정 온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT settemp AS settemp_recent,    timestamp AS settemp_recent_time FROM qr ORDER BY timestamp DESC LIMIT 1;",
  "final_result": "result"
    }
  },
  {
    "Input": "옆반의 가장 최근 온도랑 설정온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT roomtemp AS roomtemp_recent, settemp AS settemp_recent, timestamp AS recent_time FROM qr ORDER BY timestamp DESC LIMIT 1;",
  "final_result": "result"
    }
  }
,
  {
    "Input": "지금 옆반 너무 추워",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, settemp, oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '3 hours' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND oper IS NOT NULL ORDER BY timestamp",
  "result_name": "qr",
 "SQL_O": "WITH qr AS (SELECT roomtemp, settemp, oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '3 hours' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND oper IS NOT NULL ORDER BY timestamp) SELECT roomtemp, settemp,oper,  timestamp,idu_name FROM qr ORDER BY timestamp;",
  "final_result": "qr"
    }
  },
{
  "Input": "우리반 왜이리 덥노",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, settemp, oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '3 hours' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND oper IS NOT NULL ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, settemp, oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '3 hours' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND oper IS NOT NULL ORDER BY timestamp) SELECT roomtemp, settemp, oper, timestamp, idu_name FROM qr ORDER BY timestamp;",
    "final_result": "result"
  }
}
,
 {
    "Input": "What is the current temperature in our class?",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT roomtemp AS roomtemp_recent FROM qr ORDER BY timestamp DESC LIMIT 1;",
  "final_result": "result"
    }
  },
  {
    "Input": "8일전 설정온도는?",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '8 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '7 day') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '8 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '7 day') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(settemp) AS settemp_avg FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "10년 전 오늘 우리반 온도는?",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '10 year') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '10 year' + INTERVAL '1 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '10 year') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '10 year' + INTERVAL '1 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  },
{
  "Input": "에어컨 꺼진 방들 알려줘",
  "Tags": {
    "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5','01_IB7','02_I81')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND  timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL ORDER BY timestamp;",
    "result_name": "qr",

    "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5','01_IB7','02_I81')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND  timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL ORDER BY timestamp) SELECT ARRAY_AGG(idu_name ORDER BY idu_name) AS off_names FROM qr WHERE oper = FALSE AND timestamp = (SELECT MAX(timestamp) FROM qr);",

    "final_result": "result"
  }
}
,
  {
    "Input": "지난주 설정온도가 실내온도보다 더 높았던 날은?",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
     "SQL_O": "WITH qr AS (SELECT roomtemp, settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT ARRAY_AGG(DISTINCT day ORDER BY day) AS dates FROM (SELECT TO_CHAR(timestamp, 'YYYY-MM-DD') AS day, AVG(settemp) AS avg_settemp, AVG(roomtemp) AS avg_roomtemp FROM qr GROUP BY TO_CHAR(timestamp, 'YYYY-MM-DD')) aggregated WHERE avg_settemp > avg_roomtemp;",
  "final_result": "result"
    }
  },
{
  "Input": "우리반 이번달 제일 추웠던 날은 언제냐?",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30' + INTERVAL '1 month') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30' + INTERVAL '1 month') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT ARRAY(SELECT DISTINCT TO_CHAR(timestamp,'YYYY-MM-DD') FROM qr WHERE roomtemp = (SELECT MIN(roomtemp) FROM qr) ORDER BY 1) AS coldest_dates, (SELECT MIN(roomtemp) FROM qr) AS coldest_temp;",
    "final_result": "result"
  }
}

,

{
  "Input": "어제 우리반 에어컨 작동 시간 알려줘",
  "Tags": {
    "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') AND oper IS NOT NULL ORDER BY timestamp",
    "result_name": "qr",
      "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') AND oper IS NOT NULL ORDER BY timestamp), on_events AS (SELECT timestamp FROM qr WHERE oper=TRUE ORDER BY timestamp), periods AS (SELECT timestamp AS t,LEAD(timestamp) OVER(ORDER BY timestamp) AS next_t FROM on_events) SELECT COALESCE(SUM(EXTRACT(EPOCH FROM(next_t - t)))/3600,0) AS total_time_in_hours FROM periods WHERE next_t IS NOT NULL;",
    "final_result": "result"
  }
}
,

  {
  "Input": "우리반, 옆반, 앞반 중 가장 추운 방은?",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7', '02_I81')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7', '02_I81')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT ARRAY_AGG(DISTINCT idu_name ORDER BY idu_name) AS coldest_rooms, MIN(roomtemp) AS coldest_temp FROM qr WHERE  roomtemp = (SELECT MIN(roomtemp) FROM qr);",
    "final_result": "result"
  }
},
  {
  "Input": "에어컨 제일 세게 킨 방 3개 알려줘",
  "Tags": {
    "SQL_Q": "SELECT oper, settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7', '02_I81')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT oper, settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7', '02_I81')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), latest AS (SELECT * FROM qr WHERE timestamp = (SELECT MAX(timestamp) FROM qr)), on_qr AS (SELECT idu_name,settemp FROM latest WHERE oper = TRUE), ranked AS (SELECT idu_name,settemp,ROW_NUMBER() OVER (ORDER BY settemp DESC) AS rn FROM on_qr) SELECT ARRAY(SELECT idu_name FROM ranked WHERE rn <= 3 ORDER BY rn) AS top3_rooms, ARRAY(SELECT settemp FROM ranked WHERE rn <= 3 ORDER BY rn) AS top3_temps;",
    "final_result": "result"
  }
},
  {
    "Input": "작년 옆반 가장 더웠던 달은?",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE_TRUNC('year', DATE '2022-09-30' - INTERVAL '1 year') AND timestamp < DATE_TRUNC('year', DATE '2022-09-30') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp;",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE_TRUNC('year', DATE '2022-09-30' - INTERVAL '1 year') AND timestamp < DATE_TRUNC('year', DATE '2022-09-30') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp),max_temp AS (SELECT MAX(roomtemp) AS hottest_temp FROM qr),months AS (SELECT DISTINCT TO_CHAR(timestamp,'YYYY-MM') AS hottest_month FROM qr WHERE roomtemp = (SELECT hottest_temp FROM max_temp)) SELECT ARRAY_AGG(hottest_month ORDER BY hottest_month) AS hottest_months,(SELECT hottest_temp FROM max_temp) AS hottest_temp FROM months;",
  "final_result": "result"
    }
  },
 {
  "Input": "지난달에 설정온도랑 현재온도 차이가 제일 많이 났던 때는 언제야?",
  "Tags": {
    "SQL_Q": "SELECT settemp, roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30' - INTERVAL '1 month') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",

    "result_name": "qr",

    "SQL_O": "WITH qr AS (SELECT settemp, roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30' - INTERVAL '1 month') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), diffs AS (SELECT qr.*, roomtemp - settemp AS temp_diff FROM qr), maxv AS (SELECT MAX(ABS(temp_diff)) AS max_diff FROM diffs) SELECT ARRAY(SELECT DISTINCT TO_CHAR(timestamp,'YYYY-MM-DD HH24:MI:SS') FROM diffs, maxv WHERE ABS(diffs.temp_diff)=maxv.max_diff ORDER BY 1) AS max_diff_timestamps, ARRAY(SELECT DISTINCT settemp FROM diffs, maxv WHERE ABS(diffs.temp_diff)=maxv.max_diff ORDER BY 1) AS max_diff_settemps, ARRAY(SELECT DISTINCT roomtemp FROM diffs, maxv WHERE ABS(diffs.temp_diff)=maxv.max_diff ORDER BY 1) AS max_diff_roomtemps, (SELECT max_diff FROM maxv) AS max_diff;",

    "final_result": "result"
  }
}
,
  {
    "Input": "지난 한달간 설정온도 평균을 알려줘.",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE '2022-09-30' - INTERVAL '1 month' AND timestamp <= DATE '2022-09-30' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE '2022-09-30' - INTERVAL '1 month' AND timestamp <= DATE '2022-09-30' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(settemp) AS settemp_avg FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "What is the temperature difference between our class and the adjacent class right now?",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) , t AS ( SELECT MAX(CASE WHEN idu_name = '01_IB5' THEN roomtemp END) AS roomtemp_ours,  MAX(CASE WHEN idu_name = '01_IB7' THEN roomtemp END) AS roomtemp_beside FROM qr) SELECT roomtemp_ours, roomtemp_beside, roomtemp_ours - roomtemp_beside AS temp_diff FROM t;",
  "final_result": "result"
    }
  },
  {
    "Input": "앞반 전원 켜져있어?",
    "Tags": {
  "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I81')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('02_I81')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL ORDER BY timestamp) SELECT oper FROM qr ORDER BY timestamp DESC LIMIT 1;",
  "final_result": "result"
    }
  },
  {
    "Input": "오늘 우리반 에어컨 전원이 처음 켜진 시각 알려줘.",
    "Tags": {
  "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE '2022-09-30' AND timestamp < DATE '2022-09-30' + INTERVAL '1 day' AND oper IS NOT NULL ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE '2022-09-30' AND timestamp < DATE '2022-09-30' + INTERVAL '1 day' AND oper IS NOT NULL ORDER BY timestamp) SELECT MIN(timestamp) AS first_on FROM qr WHERE  oper = TRUE;",
  "final_result": "result"
    }
  },
  {
    "Input": "지난주 우리반은 대체로 몇 도로 설정되어 있었나요?",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), mode_val AS (SELECT settemp AS settemp_mode FROM qr GROUP BY settemp ORDER BY COUNT(*) DESC LIMIT 1), avg_val AS (SELECT AVG(settemp) AS settemp_avg FROM qr) SELECT (SELECT settemp_mode FROM mode_val) AS settemp_mode,(SELECT settemp_avg FROM avg_val) AS settemp_avg;",
  "final_result": "result"
    }
  },
  {
    "Input": "옆반 어제 아침과 저녁의 설정온도 차이는 얼마나 돼?",
    "Tags": {
  "SQL_Q": ["SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') + INTERVAL '6 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') + INTERVAL '9 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp","SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') + INTERVAL '18 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') + INTERVAL '21 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp;"],
  "result_name": ["qr_morning","qr_evening"],
  "SQL_O": "WITH qr_morning AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') + INTERVAL '6 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') + INTERVAL '9 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp),qr_evening AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') + INTERVAL '18 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 day') + INTERVAL '21 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT (SELECT AVG(settemp) FROM qr_morning) AS morning_avg, (SELECT AVG(settemp) FROM qr_evening) AS evening_avg, (SELECT AVG(settemp) FROM qr_evening) - (SELECT AVG(settemp) FROM qr_morning) AS temp_diff;",
  "final_result": "result"
    }
  },
  {
    "Input": "지금 옆반 에어컨 상태 알려줘",
    "Tags": {
  "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL ORDER BY timestamp) SELECT oper FROM qr ORDER BY timestamp DESC LIMIT 1;",
  "final_result": "result"
    }
  },
  {
    "Input": "이번주 우리반 평균 온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30' + INTERVAL '1 week') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30' + INTERVAL '1 week') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "이번달 우리반 설정온도 최대값과 최소값 알려줘",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30' + INTERVAL '1 month') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30' + INTERVAL '1 month') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT MAX(settemp) AS settemp_max, MIN(settemp) AS settemp_min FROM qr;",
  "final_result": "result"
    }
  },
  {
  "Input": "우리반과 옆반중 더 추운곳은 어디야?",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5', '01_IB7')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), latest AS (SELECT idu_name,roomtemp FROM qr WHERE timestamp = (SELECT MAX(timestamp) FROM qr)), temps AS (SELECT MAX(CASE WHEN idu_name = '01_IB5' THEN roomtemp END) AS roomtemp_ours,MAX(CASE WHEN idu_name = '01_IB7' THEN roomtemp END) AS roomtemp_beside FROM latest) SELECT roomtemp_ours,roomtemp_beside,ABS(roomtemp_ours-roomtemp_beside) AS temp_diff,CASE WHEN roomtemp_beside < roomtemp_ours THEN '01_IB7' ELSE '01_IB5' END AS colder_idu FROM temps;",
    "final_result": "result"
  }
}
,
  {
    "Input": "에어컨 켜져있어?",
    "Tags": {
  "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND oper IS NOT NULL ORDER BY timestamp) SELECT oper FROM qr ORDER BY timestamp DESC LIMIT  1;",
  "final_result": "result"
    }
  },
  {
    "Input": "How hot was our class over the last month?",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30' - INTERVAL '1 month') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('month', DATE '2022-09-30' - INTERVAL '1 month') AND timestamp < DATE_TRUNC('month', DATE '2022-09-30') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  },
{
  "Input": "우리 반 에어컨이 가장 오래 작동했던 날은 언제야?",
  "Tags": {
    "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '7 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' + INTERVAL '1 day') AND oper IS NOT NULL ORDER BY timestamp",

    "result_name": "qr",

     "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '7 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' + INTERVAL '1 day') AND oper IS NOT NULL ORDER BY timestamp), qr_with_prev AS (SELECT oper, idu_name, timestamp, LAG(timestamp) OVER (ORDER BY timestamp) AS prev_ts FROM qr), spans AS (SELECT DATE(timestamp) AS d, CASE WHEN oper AND prev_ts IS NOT NULL THEN EXTRACT(EPOCH FROM (timestamp - prev_ts)) ELSE 0 END AS on_secs FROM qr_with_prev), daily AS (SELECT d, SUM(on_secs) AS on_seconds FROM spans GROUP BY d), t AS (SELECT MAX(on_seconds) AS longest FROM daily) SELECT ARRAY(SELECT TO_CHAR(d,'YYYY-MM-DD') FROM daily, t WHERE daily.on_seconds = t.longest) AS longest_oper_dates, (SELECT longest / 3600.0 FROM t) AS longest_oper_time_in_hours;",

    "final_result": "result"
  }
}
,
 {
  "Input": "3주전 우리반 평균 실내온도 알려줘",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '21 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '20 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",

    "result_name": "qr",

    "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '21 day') AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '20 day') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",

    "final_result": "result"
  }
}
,
  {
    "Input": "지난달 오늘 오후 2시에 옆반의 설정온도는 어땠어?",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 month') + INTERVAL '14 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 month') + INTERVAL '15 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp;",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 month') + INTERVAL '14 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30' - INTERVAL '1 month') + INTERVAL '15 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(settemp) AS settemp_avg FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "오늘 오후 4시부터 6시까지 실내온도 평균 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '16 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '18 hours' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '16 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '18 hours' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "지난주 수요일 실내온도 최고값 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') + INTERVAL '2 day' AND timestamp < DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') + INTERVAL '3 day' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') + INTERVAL '2 day' AND timestamp < DATE_TRUNC('week', DATE '2022-09-30' - INTERVAL '1 week') + INTERVAL '3 day' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT MAX(roomtemp) AS roomtemp_max FROM qr;",
  "final_result": "result"
    }
  },
{
  "Input": "오늘 오전 11시에 옆반의 실내온도는 어땠어?",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp = DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '11 hours' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp = DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '11 hours' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT roomtemp FROM qr ORDER BY timestamp DESC LIMIT 1;",
    "final_result": "result"
  }
}
,
 {
  "Input": "오늘 오후 2시에 옆반의 설정온도는 어땠어?",
  "Tags": {
    "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp = DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '14 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp = DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '14 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT settemp FROM qr ORDER BY timestamp DESC LIMIT 1;",
    "final_result": "result"
  }
},
{
  "Input": "Why is our classroom so cold",
  "Tags": {
    "SQL_Q": "SELECT roomtemp, settemp, oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '3 hours' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND oper IS NOT NULL ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT roomtemp, settemp, oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '3 hours' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND oper IS NOT NULL ORDER BY timestamp) SELECT roomtemp, settemp, oper, timestamp,idu_name FROM qr;",
    "final_result": "result"
  }
}
,
{
  "Input": "오늘 아침과 저녁의 온도차이는 얼마나 돼?",
  "Tags": {
    "SQL_Q": ["SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '6 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '9 hours' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp","SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '18 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '21 hours' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp"],
    "result_name": ["qr_morning","qr_evening"],
    "SQL_O": "WITH qr_morning AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '6 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '9 hours' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp),qr_evening AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '18 hours' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '21 hours' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT (SELECT AVG(roomtemp) FROM qr_morning) AS morning_avg, (SELECT AVG(roomtemp) FROM qr_evening) AS evening_avg, (SELECT AVG(roomtemp) FROM qr_evening) - (SELECT AVG(roomtemp) FROM qr_morning) AS temp_diff;",
    "final_result": "result"
  }
}
,
  {
    "Input": "지금 옆반 온도랑 우리반 온도 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7', '01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7', '01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), recent AS (SELECT idu_name,roomtemp FROM qr WHERE timestamp = (SELECT MAX(timestamp) FROM qr)) SELECT MAX(CASE WHEN idu_name='01_IB5' THEN roomtemp END) AS roomtemp_ours, MAX(CASE WHEN idu_name='01_IB7' THEN roomtemp END) AS roomtemp_beside FROM recent;",
  "final_result": "result"
    }
  },
  {
    "Input": "현재 설정온도랑 실내온도 차이 알려줘.",
    "Tags": {
  "SQL_Q": "SELECT settemp, roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '5 minutes' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp),  last_row AS (SELECT * FROM qr ORDER BY timestamp DESC LIMIT 1) SELECT settemp, roomtemp, roomtemp - settemp AS temp_diff FROM   last_row;",
  "final_result": "result"
    }
  },
{
  "Input": "지난주에 설정온도와 실내온도 차이가 가장 많이 났던 날은?",
  "Tags": {
    "SQL_Q": "SELECT settemp, roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30') - INTERVAL '1 week' AND timestamp < DATE_TRUNC('week', DATE '2022-09-30') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
      "SQL_O": "WITH qr AS (SELECT settemp, roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30') - INTERVAL '1 week' AND timestamp < DATE_TRUNC('week', DATE '2022-09-30') AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), t AS (SELECT MAX(roomtemp - settemp) AS max_diff FROM qr) SELECT ARRAY(SELECT DISTINCT TO_CHAR(timestamp,'YYYY-MM-DD HH24:MI:SS') FROM qr, t WHERE (roomtemp - settemp)=max_diff ORDER BY 1) AS max_diff_timestamps, ARRAY(SELECT DISTINCT settemp  FROM qr, t WHERE (roomtemp - settemp)=max_diff ORDER BY 1) AS max_diff_settemps, ARRAY(SELECT DISTINCT roomtemp FROM qr, t WHERE (roomtemp - settemp)=max_diff ORDER BY 1) AS max_diff_roomtemps, max_diff FROM t;",
    "final_result": "result"
  }
}

,
 
  {
    "Input": "이번주 설정온도가 실내온도보다 더 낮았던 날은?",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30' + INTERVAL '1 week') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('week', DATE '2022-09-30') AND timestamp < DATE_TRUNC('week', DATE '2022-09-30' + INTERVAL '1 week') AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT ARRAY_AGG(DISTINCT day ORDER BY day) AS dates FROM (SELECT TO_CHAR(timestamp, 'YYYY-MM-DD') AS day, AVG(settemp) AS avg_settemp, AVG(roomtemp) AS avg_roomtemp FROM qr GROUP BY TO_CHAR(timestamp, 'YYYY-MM-DD')) aggregated WHERE avg_settemp < avg_roomtemp;",
  "final_result": "result"
    }
  },
  {
    "Input": "어제 전원 껐어?",
    "Tags": {
  "SQL_Q": "SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') - INTERVAL '1 day' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') AND oper IS NOT NULL ORDER BY timestamp;",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') - INTERVAL '1 day' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') AND oper IS NOT NULL ORDER BY timestamp) SELECT oper FROM qr ORDER  BY timestamp DESC LIMIT  1;",
  "final_result": "result"
    }
  },
{
  "Input": "최근에 설정온도가 가장 높았던 날 알려줘",
  "Tags": {
    "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') - INTERVAL '1 week' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '1 day' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
    "result_name": "qr",
    "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') - INTERVAL '1 week' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '1 day' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp), maxv AS (SELECT MAX(settemp) AS max_settemp FROM qr) SELECT ARRAY_AGG(DISTINCT TO_CHAR(timestamp, 'YYYY-MM-DD') ORDER BY TO_CHAR(timestamp, 'YYYY-MM-DD')) AS max_settemp_dates, (SELECT max_settemp FROM maxv) AS max_settemp FROM qr, maxv WHERE qr.settemp = maxv.max_settemp;",
    "final_result": "result"
  }
}
,
  {
    "Input": "지난 3일 동안 우리반 실내 온도 평균 값 알려줘.",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') - INTERVAL '3 days' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '1 day' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE_TRUNC('day', DATE '2022-09-30') - INTERVAL '3 days' AND timestamp < DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '1 day' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(roomtemp) AS roomtemp_avg FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "오늘 오후 5시에 옆반의 설정온도는 어땠어?",
    "Tags": {
  "SQL_Q": "SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp = DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '17 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT settemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB7')) AND timestamp = DATE_TRUNC('day', DATE '2022-09-30') + INTERVAL '17 hours' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT AVG(settemp) AS settemp FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "올해 여름 우리반 실내온도 최대값과 최소값 알려줘",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE '2022-06-01' AND timestamp < DATE '2022-09-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= DATE '2022-06-01' AND timestamp < DATE '2022-09-01' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' ORDER BY timestamp) SELECT MAX(roomtemp) AS roomtemp_max, MIN(roomtemp) AS roomtemp_min FROM qr;",
  "final_result": "result"
    }
  },
  {
    "Input": "지금 우리반 너무 더워",
    "Tags": {
  "SQL_Q": "SELECT roomtemp, settemp, oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '3 hours' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND oper IS NOT NULL ORDER BY timestamp",
  "result_name": "qr",
  "SQL_O": "WITH qr AS (SELECT roomtemp, settemp, oper, (SELECT name FROM idu_t WHERE id = data_t.idu_id) AS idu_name, timestamp FROM data_t WHERE idu_id IN (SELECT id FROM idu_t WHERE name IN ('01_IB5')) AND timestamp >= TIMESTAMP '2022-09-30 12:00:00' - INTERVAL '3 hours' AND timestamp <= TIMESTAMP '2022-09-30 12:00:00' AND roomtemp IS NOT NULL AND roomtemp IS DISTINCT FROM 'NaN' AND settemp IS NOT NULL AND settemp IS DISTINCT FROM 'NaN' AND oper IS NOT NULL ORDER BY timestamp) SELECT roomtemp, settemp, oper, timestamp,idu_name FROM qr;",
  "final_result": "result"
    }
  }]
  
